<!DOCTYPE html>
<html lang="en">
  <head>
    
    <!-- block templates/base.html head -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Greg Albrecht's ampledata.org">
    <meta name="author" content="Greg Albrecht">

    <script type="text/javascript">
      var _gaq = _gaq || [];

      _gaq.push(['_setAccount', 'UA-30633417-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <title>Radio Security</title>
    <link href="http://feeds.feedburner.com/ampledata" rel="alternate" title="RSS" type="application/rss+xml" />

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
    <link href="syntax.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
    <!-- endblock templates/base.html head -->
    
  </head>

  <body>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Radio Security</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="https://www.linkedin.com/in/ampledata">LinkedIn</a></li>
              <li><a href="https://twitter.com/ampledata">Twitter</a></li>
              <li><a href="https://github.com/ampledata">Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
      </nav>

<div class="container">
<!-- block templates/base.html content -->

<!-- block templates/article.html content -->
<h1>Land Mobile Radio Security</h1>
<p>This article is a review of the security features of various Land Mobile 
Radio Systems available presently. There are many communications products that 
offer features labeled as 'secure', and there are just as many notions of what 
'secure' means. I will develop a rubric through which the user of a Land Mobile 
System can select the features of a System that make it 'secure' to them.</p>
<p>One of the primary uses of LMR systems is for Push-to-Talk voice communication, 
where human voice is the medium. Most LMR systems do not protect this medium in 
any way, sending messages in the clear for anyone to intercept &amp; hear. For users 
who need to protect their messages from interception, they may choose a security 
feature that offers some privacy guarantee. Many of the same users also need to 
ensure the identity of other users on the System, so will choose a security 
feature that authenticates users of the system.</p>
<p>Potential threats to LMR systems include the ability to intercept any user's 
transmissions, which is easily achieved with commercial-off-the-shelf equipment. 
Often secondary-market devices are available that can be configured to act as 
users of a System, giving the operator the ability to intercept and send 
messages. Finally, edge devices like hand-held walkie-talkies can be easily 
misplaced, lost, or stolen, allowing an attacker to have direct access to the 
System.</p>
<p>Almost every LMR system is susceptible to interference, both deliberate and 
accidental. This can vary in range from a hobby kit for kids, to some nearby
electronic noise source.</p>
<p>Assumptions</p>
<ul>
<li>Systems are installed and configured per the manufacturers specifications.</li>
<li>Systems adhere to the regulatory specifications ruling the region in which they 
operate (emission types, license, power, etc)</li>
</ul>
<p>Assets</p>
<ol>
<li>The 'message' in the human voice PTT</li>
<li>The authoritative &amp; presented identity of the Speaker</li>
</ol>
<p>Threats</p>
<ol>
<li>Interception of PTT 'message'</li>
<li>Impersonating a User</li>
</ol>
<h2>Security vs. Access</h2>
<p>A dimension to take into consideration is that, unlike an IP network where 
the underlying protocol is built around multiple-access, LMR systems can vary 
in how they implement multiple-access, if at all. What this means is that an 
IP network can have several devices sharing the same basic transport (IP over 
Ethernet, or IP over WiFi for example), the Radio Frequencies and systems that 
operate LMR can be configured to share this transport using different methods.</p>
<p>For example, a single LMR radio frequency can be shared among multiple users 
by implementing a access-control mechanism like CTCSS or DCS. With these 
mechanisms, only users sharing the same 'Code' can hear each other. However, 
this does not inhibit other users from hearing them, nor does it inhibit the 
channel from being used by other users, sometimes simultaneously. This can 
lead to both Availability issues, or Confidentiality issues (C-i-A). 
Additionally, CTCSS &amp; DCS codes are not private, so any other user can re-use 
the same code, defeating the Integrity property (c-I-a).</p>
<h2>Nomenclature</h2>
<ul>
<li><strong>Plaintext</strong>: Clear, unencrypted, plain messages (both Voice &amp; Text).</li>
<li><strong>Ciphertext</strong>: Encrypted messages (Voice &amp; Text).</li>
</ul>
<h2>Terms</h2>
<ul>
<li><strong>CTCSS</strong>: Continuous Tone-Coded Squelch System</li>
<li><strong>PL</strong>: Privacy Line</li>
<li><strong>DCS</strong>: Digital-Coded Squelch</li>
<li><strong>LMR</strong>: Land Mobile Radio </li>
<li>AES: A</li>
<li>DES:</li>
<li>NXDN:</li>
<li>DMR:</li>
<li>dPMR:</li>
<li>Part 97:</li>
<li>Part 15:</li>
<li>GMRS:</li>
<li>FRS:</li>
<li>P25:</li>
<li>C-I-A Triad:</li>
<li>UE</li>
</ul>
<h2>Key Loaders &amp; Fill Devices</h2>
<p>A <a href="https://en.wikipedia.org/wiki/Fill_device">Key Loader</a>, also sometimes 
called a Fill Device, is a device used to load cryptographic keys onto an 
encryption device. In the case of LMR systems that implement private-key 
crytography, such as DES &amp; AES, Key Loaders are filled with key material and 
then physically attached to EU devices to install the private keys. </p>
<p>Of immediate concern to anyone implementing a system that requires a Key 
Loading is the security of the private keys themselves. Potential threats to
these the private key assets start with the physical security of the Key 
Loader, but also include any other systems or modules in the private key 
loading pipeline. For example, a computer may be used to generate or transfer 
the private keys, introducing various computer security vectors into the 
threat model. Extreme care should be taken.</p>
<p><img alt="Key Loading" src="img/radio_security/key_loading.png" /></p>
<h1>Analog Radio Systems</h1>
<h2>DES ADP</h2>
<p>TK</p>
<h2>Analog Voice Inversion / Voice Scrambling</h2>
<p>Oona Räisänen has an excellent write-up of Analog Voice Inversion in her 
<a href="http://www.windytan.com/2013/05/descrambling-voice-inversion.html">blog</a>:</p>
<blockquote>
<p>it inverts the audio spectrum of a signal, making the lowest frequencies the 
highest and vice versa. It is not considered encryption;</p>
</blockquote>
<p>Voice Inversion is true <a href="https://en.wikipedia.org/wiki/Security_through_obscurity">security-through-obscurity</a> 
and offers protection from only passive interception (that is, someone 
accidentally tuning to your frequency). Under an active attack, the 'key space' 
for Voice Inversion varies between 8 and 16 'codes', and can easily be 
descrambled on a receiver with either a matching code programmed in, or with a 
tool like <a href="http://www.windytan.com/2017/09/descrambling-split-band-voice-inversion.html">deinvert</a>.</p>
<h1>Digital Radio Systems</h1>
<h2>Kenwood NEXEDGE / NXDN / ICOM IDAS</h2>
<blockquote>
<p>This section adopted from the following specifications:</p>
<ul>
<li>NXDN Technical Specifications, TS 1-D Version 1.3. JVC KENWOOD Corporation 
and Icom Incorporated.</li>
</ul>
</blockquote>
<p>Kenwood NEXEDGE is a commercial implementation of the NXDN open standard for LMR.
Many Kenwood NXDN-compatible radios offer compatibility with other LMR systems, 
such as DMR, dPMR, P25, and conventional analog. For the purpose of this 
evaluation we're focusing on the NXDN portion of these devices. </p>
<p>The NXDN specification describes three levels of 'encryption algorithm' security:</p>
<ol>
<li>No Guard Level: No Encryption.</li>
<li>"Low Guard Level": "Scramble Encryption"</li>
<li>"High Guard Level": (this level is further split into:)<ol>
<li>"DES Encryption" <a href="https://csrc.nist.gov/csrc/media/publications/fips/46/3/archive/1999-10-25/documents/fips46-3.pdf">FIPS 46-3</a></li>
<li>"AES Encryption" <a href="https://csrc.nist.gov/publications/detail/fips/197/final">FIPS 197</a> in OFB Mode <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST 800-38A</a></li>
</ol>
</li>
</ol>
<p>Both "Low Guard" &amp; "High Guard" encryption happen immediately after the Vocoder 
stage on the transmitting side, or immediately before the Vocoder stage on the 
receiving side. With encryption &amp; decryption happening early in the voice 
processing stage, this ensures that lower layers of the NXDN CAI lack access to 
the Plaintext.</p>
<p><img alt="NXDN Encryption Layers" src="img/radio_security/nxdn_encryption_layers.png" /></p>
<h3>NXDN Low Guard Scramble Encryption</h3>
<p>Scramble Encryption offers a 32,767-key key-space for both voice &amp; data. </p>
<h3>NXDN High Guard DES Encryption</h3>
<p>NXDN DES uses a 56-bit key length. Keys must be pre-loaded onto devices before 
use, and are identified by a pre-shared Key ID. The 64-bit Initialization Vector 
within the DES OFB is seeded with random data, with the generation method left 
up to the party implementing the protocol. Initialization Vector values are 
synchronized within the same frame as the shared Key ID.</p>
<p><code>VCALL_IV</code> message content:</p>
<div class="codehilite"><pre><span></span> 2 bits      6 bits 64 bits
+-----------+------+---------------------+
|Cipher Type|Key ID|Initialization Vector|
+-----------+------+---------------------+
</pre></div>
<!-- endblock templates/article.html content -->

<!-- endblock templates/base.html content -->
</div>


<!-- block templates/article.html footer -->
<h2>Share</h2>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="ampledata">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'ampledata';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<!-- block templates/base.html footer -->
<footer class="footer">
  <div class="container">
      Contact Greg Albrecht: Email <a
        href="mailto:gba@gregalbrecht.com">gba@gregalbrecht.com</a> Twitter <a
        href="http://twitter.com/ampledata">@ampledata</a> Github <a
        href="https://github.com/ampledata">ampledata</a>.

      <p>This work by <a href="http://twitter.com/ampledata">Greg Albrecht</a> is licensed under a <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>. Based on a work at <a href="http://ampledata.org">ampledata.org</a>.</p>
  </div>
</footer>
<!-- endblock templates/base.html footer -->

<!-- endblock templates/article.html footer -->



<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>