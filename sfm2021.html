<!DOCTYPE html>
<html lang="en">
  <head>
    
    <!-- block templates/base.html head -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Greg Albrecht's ampledata.org">
    <meta name="author" content="Greg Albrecht">

    <script type="text/javascript">
      var _gaq = _gaq || [];

      _gaq.push(['_setAccount', 'UA-30633417-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <title>Sfm2021</title>
    <link href="http://feeds.feedburner.com/ampledata" rel="alternate" title="RSS" type="application/rss+xml" />

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
    <link href="syntax.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
    <!-- endblock templates/base.html head -->
    
  </head>

  <body>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Sfm2021</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="https://www.linkedin.com/in/ampledata">LinkedIn</a></li>
              <li><a href="https://twitter.com/ampledata">Twitter</a></li>
              <li><a href="https://github.com/ampledata">Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
      </nav>

<div class="container">
<!-- block templates/base.html content -->

<!-- block templates/article.html content -->
<h1>Enhancing Situational Awareness using Ham Radio &amp; TAK</h1>
<p>This article describes a project to enhance unit tracking &amp; Situational 
Awareness at the San Francisco Marathon in September 2021. This project 
resulted in the creation of several novel tools and solutions, outlined in 
detail below.</p>
<p><a href="img/sfm2021/sfm2021_tak.png"><img alt="SFM2021 TAK Infrastructure" src="img/sfm2021/sfm2021_tak_25p.png" /></a></p>
<h2>Background &amp; Motivation</h2>
<p>The <a href="https://www.thesfmarathon.com/">San Francisco Marathon</a> is a yearly foot 
race held in between San Francisco &amp; Marin county Runners can participate in 
races ranging from 5K to Ultramarathon covering a diverse range of 
environments from city to waterfront.</p>
<p>The <a href="https://www.sfarc.org/">San Francisco Radio Club (SFRC)</a> provides 
communications between 30 first aid &amp; watering stations, 5 SAGs, a 
motorcycle-based Sweep, and other down-range spotters. SAG units are used to 
pickup and delivery racers who cannot continue back to race finish. Tracking 
these units is the responsibility of the SFRC Net Control operators, a task 
accomplished in previous years with a combination of paper maps and 
computer-based APRS.</p>
<p>For the 2021 race an effort was made to fuse multiple disparate unit tracking 
systems into a single pane of glass common operating picture (COP) for display 
at forward event command/ICP.</p>
<h2>Challenges &amp; Solutions</h2>
<p><strong>Geography</strong></p>
<p>The marathon's geographic footprint covers both dense urban canyons, open 
ocean crossings, and regions in-between. These different environments present 
different signal and location positioning challenges. A myriad of tracking 
devices were used to address these challenges and each unit could carry more 
than one different tracking device. For example, a unit in a larger vehicle 
could cary both an APRS Beacon and a TAK Tracker.</p>
<ul>
<li>Solution: Use multiple different tracking systems.</li>
</ul>
<p><strong>Common Operating Picture Nomenclature &amp; Visual Communication</strong></p>
<p>Different position location information (PLI) sources use different unit 
identifying information. Of need for an effective COP is the use of a unified 
nomenclature for units &amp; assets. These"tactical callsigns" can vary by event, 
sponsoring entity and command agency. (Probably covered within NIMS?) </p>
<p>A particular challenge of these different tracking systems is the disparate 
nomenclature each system uses for tracked units. (e.g. Some systems use verbose 
unit identifiers, others are simple callsigns.) Additionally, regardless of the 
unit name or callsign, the COP may have its own common language &amp; visual 
representation (icon).</p>
<ul>
<li>Solution: Add a nomenclature normalization layer.</li>
</ul>
<p>Additionally, the ability to visually represent unit 'typing' using a common 
reference (icons) aids in disambiguation and communication.</p>
<ul>
<li>Solution: Create, apply &amp; utilize a COP icon set.</li>
</ul>
<p><strong>Situational Awareness Application Diversity</strong></p>
<p>There are several Situational Awareness (SA) applications available across 
various form factors and end user devices (EUD). Each SA App adheres to 
different formats &amp; levels of support for PLI Data.</p>
<ul>
<li>Solution: Add a PLI data transformation layer.</li>
</ul>
<h2>Summary</h2>
<p>A fusion of multiple different unit tracking systems overcame many of the 
challenges of holding a special event in a diverse and vast geographical 
footprint. Nomenclature normalization and standardization of icons for visual 
representation enhanced SA understanding across organizational units. Users 
in different operating modes &amp; environments can use native SA Apps to achieve an 
event-wide COP.</p>
<h3>TAK Tracker</h3>
<p><strong>TAK Tracker Limitations</strong></p>
<ul>
<li>Only uses GPS Location Provider, limiting device location &amp; positioning in 
   GPS Denied environments, such as indoors, underground, or within mobile 
   command centers with metal shielding. </li>
<li>Cannot load Data Packages from SD Card physical media, requiring either 
  download of a data package through an online means (website, etc), or adb 
  file ‘push’ with Android Developer Tools. </li>
<li>Data Packages do not support ‘macros’ or name scripting. Callsign must be 
  manually set at install time.</li>
<li>Data Packages cannot be installed from a remote HTTP endpoint in either ATAK 
  or TAK Tracker.</li>
</ul>
<p><strong>TAK Tracker Feature Enhancements</strong></p>
<ol>
<li>Allow auto-configuring using QR codes or deep links.</li>
<li>Macro style callsign configuration. E.g. ‘CA-SF-SFM-${IMEI:-4}’</li>
<li>Change TAK Tracker to support FusedLocationProvider.</li>
<li>Change TAK Tracker to allow loading Data Packages from physical media. </li>
<li>Change ATAK &amp; TAK Tracker to allow loading Data Packages from HTTP 
   endpoints.</li>
</ol>
<p><strong>Unexpected Outcome</strong></p>
<p>TAK Tracker's use of Android GPS Location Provider alone did not present a 
notable unit tracking hindrance. This could be due to all units being either 
outdoors or in moving vehicles, and none being indoors or underground.</p>
<h3>Future Considerations</h3>
<p>Several gaps were identified in this project and are outlined below.</p>
<p><strong>Add the CAD incident locations to the COP</strong></p>
<p>Allow both dispatch/MEDCOM and field units to populate a COP map display with 
incident location and other SA data (call type, nature, disposition, etc).</p>
<p><a href="img/sfm2021/runner_down.png"><img alt="&quot;Runner Down&quot; CAD incident on a map" src="img/sfm2021/runner_down_25p.png" /></a></p>
<p><strong>Create a SA Kiosk</strong></p>
<p>Forward operating positions, incident command posts (ICP), and emergency 
operations centers (EOC) can vary in available IT infrastructure, capabilities, 
and upkeep. Creating a "SA Kiosk", similar to a Google Chromecast, with PLI 
data feed pre-configured &amp; mapping sources or tiles pre-loaded, would ease COP 
implementation in these environments.</p>
<p><strong>Create dynamic Data Package endpoint</strong></p>
<p>To ease configuration of TAK clients like WinTAK, ATAK, TAK Tracker, et al, 
Data Packages can be created dynamically from within a Node-RED Flow. This 
allows on-the-fly or in-the-field changes to nomenclature, icons, map imagery, 
and more, programmatically without needing to manually create Data Packages.</p>
<h2>Details</h2>
<h3>Multiple Tracking Systems</h3>
<p><a href="img/sfm2021/logical_data_diagram.png"><img alt="Logical data flow" src="img/sfm2021/logical_data_diagram_25p.png" /></a></p>
<p>Several unit tracking systems were used, each chosen to meet the various 
geographical, signal and location positioning challenges of the event's 
footprint.</p>
<ol>
<li>VHF Ham Radio APRS Beacons</li>
<li><a href="https://www.orionlabs.io/">Orion Labs Push-to-Talk smartphone App</a></li>
<li>TAK Tracker smartphone App</li>
<li><a href="https://discover.garmin.com/en-US/inreach/personal/">Garmin inReach satellite location trackers</a></li>
</ol>
<h3>Cloud Infrastructure</h3>
<p>Two <a href="https://cloud.google.com/">Google Cloud Computing Servers</a> instances 
were created:</p>
<ol>
<li>CentOS: TAK Server</li>
<li>Debian: Docker, node-red, tileserver-gl, ownCloud</li>
</ol>
<h3>TAK Server &amp; TAK Tracker</h3>
<p>TAK Server was utilized as a PLI data destination endpoint for TAK Tracker, 
and a 'transformed' PLI data source for APRS &amp; WinTAK. Individual users were 
auto-enrolled from ATAK &amp; WinTAK. </p>
<p>A shared certificate was created for TAK Tracker to speed EUD provisioning. 
This certificate was bundled with a ATAK Preferences file into a Data Package 
and loaded onto the EUD using 'adb push' from an Android development 
workstation. Once loaded the TAK Tracker settings UI was used to install the 
Data Package and complete configuration, including updating the the callsign to 
replace the 'XXXX example with the last for digits of the IMEI.</p>
<p><a href="img/sfm2021/taktracker_setup.png"><img alt="TAK Tracker Setup Screen" src="img/sfm2021/taktracker_setup_25p.png" /></a></p>
<h3>Node-RED</h3>
<p><a href="img/sfm2021/nodered_screenshot.png"><img alt="Node-RED Screenshot" src="img/sfm2021/nodered_screenshot_50p.png" /></a></p>
<p>Node-RED was used as a PLI data transformation layer. A Node-RED Flow was 
created to ingest PLI data from different sources and rename or 'normalize' 
the data to fit the COP.</p>
<p>This Node-RED "PLI normalization" Flow added new capabilities over previous 
tracking solutions:</p>
<ol>
<li>A unit could be tracked using one or more different sources</li>
<li>Unit nomenclature can be normalized to fit the COP</li>
<li>Unit icons can be normalized to fit the COP visual language</li>
</ol>
<p><strong>Multiple Sources</strong></p>
<p>The Node-RED Flow was configured to read PLI data from every tracking system 
and ingest their respective PLI data. Once data was ingested, it could be 
transformed and delivered to other SA Apps in their native PLI data formats.</p>
<p><strong>Renaming</strong></p>
<p><a href="img/sfm2021/name_normalization.png"><img alt="Name normalization" src="img/sfm2021/name_normalization_50p.png" /></a></p>
<p>The Node-RED Flow's "PLI normalization" capability allowed the transformation 
of a disparate PLI Data and its respective unit identifiers to be normalized to
the COP nomenclature.</p>
<p>As an example, an APRS Beacon could be transmitting to the APRS Network with a 
callsign of 'W2GMD-TAC-09', while an Orion user could be online with the 
username 'Greg A.'. The PLI Normalization Flow can rename each of those to the 
unit identifier 'SAG 2'.</p>
<p><strong>Icons &amp; Reference Image</strong> </p>
<p><a href="img/sfm2021/sag_2.png"><img alt="SAG 2" src="img/sfm2021/sag_2.png" /></a></p>
<p>The Node-RED Flow allowed a single reference image to be applied to each unit 
across different SA Apps.  As there was existing COP visual language in use, 
Font Awesome fonts were used a standard reference icons for all SA Apps. A 
Data Package was created for WinTAK &amp; ATAK matching that used by Node-RED 
Worldmap.</p>
<h3>tileserver-gl</h3>
<p><a href="img/sfm2021/tileserver_screenshot.png"><img alt="tileserver-gl screenshot" src="img/sfm2021/tileserver_screenshot_50p.png" /></a></p>
<p><a href="https://github.com/maptiler/tileserver-gl">tileserver-gl</a> was used to deliver 
event map tiles to EUDs. Maps were taken from an event planning PDF and split 
into individual map tiles using mapTiler's desktop tool. tileserver-gl was 
running inside a Docker container on the Google Cloud Instance Debian host.</p>
<h3>Camera feeds</h3>
<p>A common &amp; routine request over the radio was for location census, e.g. "How 
many runners are there currently at the intersection of 16th &amp; Potrero 
Streets?" This question, and the radio traffic/bandwidth required to answer it, 
can instead be answered by viewing a camera fixed or pre-positioned at critical 
positions, such as start/finish, choke points or security gateways. Once 
enabled these cameras can be displayed in the COP interface.</p>
<p><a href="img/sfm2021/caltrans_camera.png"><img alt="CalTrans Camera in ATAK" src="img/sfm2021/caltrans_camera_25p.png" /></a></p>
<p><a href="img/sfm2021/bam_camera_diagram.png"><img alt="BAM Camera Diagram" src="img/sfm2021/bam_camera_diagram_50p.png" /></a></p>
<p><a href="img/sfm2021/bam_camera.png"><img alt="BAM Camera in ATAK" src="img/sfm2021/bam_camera_25p.png" /></a></p>
<h3>Other</h3>
<p>Orion utilized the Orion PTT multitenant service &amp; Orion Aster workflow tool.</p>
<p>Garmin utilized the garmin xxx service with a Garmin inReach mini</p>
<p>Smartphones used by TAK Tracker &amp; Orion users were Kyocera DuraForce Pro/Pro2 
and varied between Verizon Public Safety and AT&amp;T FirstNet.</p>
<p>VHF Ham Radio APRS beacons varied.</p>
<p><a href="img/sfm2021/live_data.jpg"><img alt="SFM 2021 Live Data" src="img/sfm2021/live_data_25p.jpg" /></a></p>
<h2>Credits</h2>
<p>The <a href="https://www.sfarc.org">San Francisco Radio Club</a> would like to thank all 
the Ham Radio operators who volunteered for this event.</p>
<p><a href="https://www.aprs.org">APRS</a> is a registered trademark Bob Bruninga, WB4APR</p>
<p>TAK Tracker, TAK Server, WinTAK &amp; ATAK are managed by the <a href="https://tak.gov">TAK Product Center</a>.</p>
<p><a href="https://nodered.org/">Node-RED</a> is copyright OpenJS Foundation and Node-RED 
contributors.</p>
<p>Funding for BAM/SFWEM was provided by a grant from <a href="http://ampr.org">Amateur Radio Digital Communications (ARDC)</a>. </p>
<p>AREDN is Copyright © 2015-2021 Amateur Radio Emergency Data Network Inc. More 
information on AREDN can be found at <a href="http://www.arednmesh.org">www.arednmesh.org</a></p>
<p>Special thanks to the Ham Radio Operators who maintain the APRS Network around 
the San Francisco Bay Area and Northern California.</p>
<!-- endblock templates/article.html content -->

<!-- endblock templates/base.html content -->
</div>


<!-- block templates/article.html footer -->
<h2>Share</h2>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="ampledata">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'ampledata';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<!-- block templates/base.html footer -->
<footer class="footer">
  <div class="container">
      Contact Greg Albrecht: Email <a
        href="mailto:gba@gregalbrecht.com">gba@gregalbrecht.com</a> Twitter <a
        href="http://twitter.com/ampledata">@ampledata</a> Github <a
        href="https://github.com/ampledata">ampledata</a>.

      <p>This work by <a href="http://twitter.com/ampledata">Greg Albrecht</a> is licensed under a <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>. Based on a work at <a href="http://ampledata.org">ampledata.org</a>.</p>
  </div>
</footer>
<!-- endblock templates/base.html footer -->

<!-- endblock templates/article.html footer -->



<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>