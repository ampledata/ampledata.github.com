<!DOCTYPE html>
<html lang="en">
  <head>
    
    <!-- block templates/base.html head -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Greg Albrecht's ampledata.org">
    <meta name="author" content="Greg Albrecht">

    <script type="text/javascript">
      var _gaq = _gaq || [];

      _gaq.push(['_setAccount', 'UA-30633417-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <title>Secure Baresip</title>
    <link href="http://feeds.feedburner.com/ampledata" rel="alternate" title="RSS" type="application/rss+xml" />

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
    <link href="syntax.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png">
    <!-- endblock templates/base.html head -->
    
  </head>

  <body>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Secure Baresip</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="https://www.linkedin.com/in/ampledata">LinkedIn</a></li>
              <li><a href="https://twitter.com/ampledata">Twitter</a></li>
              <li><a href="https://github.com/ampledata">Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
      </nav>

<div class="container">
<!-- block templates/base.html content -->

<!-- block templates/article.html content -->
<p>TL;DR: You can implement FIPS 140-2 VoIP with RFC 3711 media
 and RFC 4568 signaling using <a href="http://www.creytiv.com/baresip.html">baresip</a>.</p>
<p>This article describes implementing &amp; verifying secure VoIP using the <a href="http://www.creytiv.com/baresip.html">Baresip</a> library. 
Verification steps avoid intercepting or decrypting transport media, and instead 
rely on the protocol negotiation parameters of TLS and SIP to ensure compliance.</p>
<p>The intention is to configure a Baresip User Agent to comply with the following 
standards for secure signaling transport &amp; media:</p>
<p><strong>Signaling</strong></p>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, 
<a href="https://csrc.nist.gov/publications/detail/fips/197/final">FIPS 197</a> Advanced 
Encryption Standard (AES) with a 256 bit key (AES256).</li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final">SP 800-38D</a> Galois Counter Mode (GCM).</li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, <a href="https://csrc.nist.gov/publications/detail/fips/180/4/final">FIPS 180-4</a> Secure Hash Algorithm (SHA) with a Message Digest Size of 384 bits (SHA384).</li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4 Appendix D</a> Elliptic Curve P-384.</li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final">NIST SP 800-56A</a> Elliptic-curve Diffie–Hellman Key Agreement Protocol (ECDHE)</li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4</a> Elliptic-curve Digital Signature Algorithm (ECDSA)</li>
</ul>
<p>Our Signaling Cipher Suite is: <code>ECDHE-ECDSA-AES256-GCM-SHA384</code>  </p>
<p><strong>Media</strong></p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc3711">RFC 3711</a> The Secure Real-time Transport Protocol (SRTP)</li>
<li><a href="https://tools.ietf.org/html/rfc4568">RFC 4568</a> Session Description Protocol (SDP) Security Descriptions for Media Streams (SDES)</li>
<li><a href="https://tools.ietf.org/html/rfc4568">RFC 4568</a> SDES-SRTP Crypto-Suites</li>
</ul>
<p>Our Media "Crypto-Suite" is: <code>AES_CM_128_HMAC_SHA1_80</code></p>
<p>Many of these standards are also applicable to the <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=399&amp;id=399">National Information 
Assurance Program (NIAP) Protection Profile (PP) for Voice over IP (VoIP)</a>.</p>
<h1>Overview</h1>
<p>Voice over IP (VoIP) is a broad term that can refer to any method of transmitting 
voice communications over an IP network. When implemented out-of-the-box, the 
most common VoIP protocol, SIP, lacks any security provisions for this these 
voice communications. Fortunately the flexibility of SIP allows for enhancements 
that provide a level of security, and when configured correctly, allows the 
protocol to meet certain standards of security as selected by the US Government, 
et al.</p>
<p>We'll work through the following steps to build an environment that applies 
these enhancements to a Baresip UA, and ensure the environment meets certain 
security standards:</p>
<ol>
<li>Generate a compliant client &amp; server security certificate.</li>
<li>Compile &amp; Run the baresip UA with the security parameters set.</li>
<li>Simulate a remote SIP endpoint using OpenSSL's <code>s_client</code> &amp; <code>s_server</code>.</li>
<li>Verify the exchange between OpenSSL &amp; Baresip.</li>
</ol>
<h1>Terms</h1>
<ul>
<li>Elliptic Curve Private Key (ECPK)</li>
<li>P-384 Elliptic Curve (P-384)</li>
<li>X.509 Public Key Certificate (Cert)</li>
<li>SIP User Agent (UA)</li>
<li>Session Description Key Exchange (SDES)</li>
<li>Secure RTP (SRTP)</li>
<li>Session Initiation Protocol (SIP)</li>
<li>Test Workstation (TW)</li>
<li>OpenSSL <code>s_server</code> Simulated Receive SIP Endpoint (Simulated Receiver)</li>
<li>OpenSSL <code>s_client</code> Simulated Send SIP Endpoint (Simulated Sender)</li>
</ul>
<h1>Steps</h1>
<p>SIP, by default, passes traffic unencrypted over UDP on port 5060. When used 
RTP transport, the media is also passed in unencrypted UDP (typically on a 
random port). We're going to encrypt our media using SDES-SRTP, and wrap our 
SIP signaling in TLS over TCP on port 5061. This ensures that bout our voice 
traffic, as well as the keys used to encrypt that voice traffic, is secure.</p>
<p>To enable SIP over TLS with Baresip, we'll need to configure the Baresip UA 
with a Cert. Once configured, Baresip will be capable of sending and receiving 
calls over SIP TLS on port 5061.</p>
<p>All of these steps can take place on a single TW running both Baresip &amp; the 
Simulated SIP Send &amp; Receive Endpoints</p>
<p>These steps are broken down as follows:</p>
<ul>
<li><a href="#certificate-generation">Generate a Private Key &amp; Certificate</a></li>
<li><a href="#build--run-baresip-ua">Build &amp; Run Baresip</a></li>
<li><a href="#test--verify-configuration">Test &amp; Verify Configuration</a></li>
</ul>
<h1>Certificate Generation</h1>
<p>An end-user would be expected to generate (or provide) their own Cert for use by 
their UA, but for this example we'll generate our own self-signed Cert. </p>
<p>We're also going to generate our own ECPK using P-384.</p>
<h2>Generate an ECPK using P-384</h2>
<p>This section describes the process of generating an ECPK using P-384 on the TW. 
Additional prerequisite steps are provided to ensure the TW is capable of 
generating ECPKs using P-384.</p>
<p>All of the commands in this section must be executed on the same TW.</p>
<h3>Prerequisites</h3>
<p>The following steps verify the OpenSSL library on the TW is (1) installed and (2)
capable of generating an ECPK using P-384:</p>
<ol>
<li>Ensure OpenSSL's command-line tool 'openssl' is installed:<br />
<strong>The command:</strong><br />
<code>$ openssl version &amp;&amp; echo ''openssl' installed!'</code><br />
<strong>Should return:</strong><br />
<code>openssl installed!</code></li>
<li>Ensure OpenSSL includes support for the P-384:<br />
<strong>The command:</strong><br />
<code>$ openssl ecparam -list_curves|grep secp384r1</code><br />
<strong>Should return:</strong><br />
<code>secp384r1 : NIST/SECG curve over a 384 bit prime field</code></li>
</ol>
<h3>Steps</h3>
<ol>
<li>Generate an ECPK using P-384.<br />
<strong>The command:</strong><br />
<code>$ openssl ecparam -genkey -name secp384r1 -param_enc explicit -out example.key -param_enc named_curve</code><br />
<strong>Should create the file ‘<em>example.key</em>’, as verified with the command:</strong><br />
<code>$ ls example.key</code><br />
<strong>Should return:</strong><br />
<code>example.key</code></li>
</ol>
<h3>Verification</h3>
<ol>
<li>Display the curve used to create the ECPK.<br />
<strong>The command:</strong><br />
<code>$ openssl ecparam -in example.key -text -noout</code><br />
<strong>Should return:</strong><br />
<code>ASN1 OID: secp384r1</code><br />
<code>NIST CURVE: P-384</code></li>
</ol>
<h2>Create a Self-Signed Cert using an ECPK with P-384</h2>
<h3>Steps</h3>
<ol>
<li>Create the Cert using the OpenSSL command-line tool 'openssl':<br />
<strong>The command:</strong><br />
<code>$ openssl req -x509 -new -sha384 -days 30 -nodes -key example.key -out example.cert -subj "/C=US/ST=California/L=San Francisco/O=Example Co./OU=IT/CN=example.com"</code><br />
<strong>Should create the file ‘example.cert', as verified with the command:</strong><br />
<code>$ ls example.cert</code><br />
<strong>Should return:</strong><br />
<code>example.cert</code></li>
</ol>
<h2>Create a combined PEM file</h2>
<p>Baresip requires the Cert be provided in PEM format, with the Cert &amp; ECPK 
concatenated together into a single file:<br />
<strong>The command:</strong><br />
<code>$ cat example.key example.cert &gt; example.pem</code><br />
<strong>Should create the file ‘example.pem’, as verified with the command:</strong><br />
<code>$ ls example.pem</code><br />
<strong>Should return:</strong><br />
<code>example.pem</code></p>
<h1>Build &amp; Run Baresip UA</h1>
<p>Baresip requires the <a href="http://www.creytiv.com/re.html">libre</a> and <a href="http://www.creytiv.com/rem.html">librem</a> libraries as well as a complete build 
environment. For simplicity, we're going to use a Docker container to build and 
run the UA.</p>
<ol>
<li>
<p>Create a <code>Dockerfile</code> with the following content:  </p>
<div class="codehilite"><pre><span></span><span class="k">FROM</span> <span class="s">python:3-buster</span>

<span class="k">WORKDIR</span><span class="s"> /baresip-docker</span>

<span class="k">RUN</span> git clone https://github.com/creytiv/re.git <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">cd</span> re <span class="o">&amp;&amp;</span> <span class="se">\</span>
  make <span class="nv">RELEASE</span><span class="o">=</span>yes install

<span class="k">RUN</span> git clone https://github.com/creytiv/rem.git <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">cd</span> rem <span class="o">&amp;&amp;</span> <span class="se">\</span>
  make install

<span class="k">RUN</span> git clone https://github.com/baresip/baresip.git <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">cd</span> baresip <span class="o">&amp;&amp;</span> <span class="se">\</span>
  make <span class="nv">USE_TLS</span><span class="o">=</span>yes <span class="nv">USE_SRTP</span><span class="o">=</span>yes install

<span class="k">RUN</span> ldconfig

<span class="k">EXPOSE</span><span class="s"> 5061</span>

<span class="k">CMD</span> <span class="p">[</span><span class="s2">&quot;baresip&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;/dev_volume&quot;</span><span class="p">]</span>
</pre></div>


</li>
<li>
<p>Create an <code>accounts</code> file with the following content: </p>
<div class="codehilite"><pre><span></span>sip:a@example.com<span class="p">;</span><span class="nv">regint</span><span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="nv">transport</span><span class="o">=</span>tls<span class="p">;</span><span class="nv">mediaenc</span><span class="o">=</span>srtp-mand<span class="p">;</span><span class="nv">answermode</span><span class="o">=</span>early
</pre></div>


</li>
<li>
<p>Create a <code>config</code> file with the following content: </p>
<div class="codehilite"><pre><span></span><span class="na">module_path /usr/local/lib/baresip/modules</span>

<span class="na">module stdio.so</span>
<span class="na">module contact.so</span>
<span class="na">module debug_cmd.so</span>
<span class="na">module g711.so</span>
<span class="na">module menu.so</span>
<span class="na">module srtp.so</span>

<span class="na">module_tmp account.so</span>

<span class="na">sip_certificate /dev_volume/example.pem</span>
<span class="na">sip_listen 0.0.0.0:5060</span>
</pre></div>


</li>
<li>
<p>Build the container: <code>$ docker build -t baresip-docker .</code></p>
</li>
<li>Run the container: <code>$ docker run -itv $(pwd):/dev_volume baresip-docker:latest baresip -f /dev_volume</code></li>
<li>With the Baresip UA running, you should see the following output:<div class="codehilite"><pre><span></span>baresip v1.0.0 Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2010</span> - <span class="m">2020</span> Alfred E. Heggestad et al.
Local network address:  <span class="nv">IPv4</span><span class="o">=</span>eth0<span class="p">|</span><span class="m">192</span>.168.1.1
SIP Certificate: /dev_volume/example.pem
Populated <span class="m">0</span> contacts
aucodec: PCMU/8000/1
aucodec: PCMA/8000/1
mediaenc: srtp
mediaenc: srtp-mand
mediaenc: srtp-mandf
a@example.com: Using media encryption <span class="s1">&#39;srtp-mand&#39;</span>
Populated <span class="m">1</span> account
Populated <span class="m">2</span> audio codecs
Populated <span class="m">0</span> audio filters
Populated <span class="m">0</span> video codecs
Populated <span class="m">0</span> video filters
baresip is ready.
</pre></div>


</li>
</ol>
<p>Notice that the UA has enabled SRTP for our account: <code>a@example.com: Using media encryption 'srtp-mand'</code></p>
<h1>Test &amp; Verify Configuration</h1>
<h2>Sending (originating) a Call from the Baresip UA</h2>
<p>We're going to use the same Cert &amp; ECPK we created for the Baresip UA with the 
Simulated Receiver. The Simulated Receiver will allow the Baresip UA to create 
a TLS connection and send an initial SDP with SDES, with those connection 
parameters output in a manner viewable by the tester.</p>
<p><strong>The command:</strong><br />
<code>$ openssl s_server -accept 5071 -cert example.cert -key example.key -cipher ECDHE-ECDSA-AES256-GCM-SHA384 -named_curve secp384r1 -no_dhe</code></p>
<p><strong>Should return:</strong>  </p>
<div class="codehilite"><pre><span></span><span class="err">    Using default temp ECDH parameters</span>
<span class="err">    ACCEPT</span>
</pre></div>


<h3>Steps</h3>
<p>These steps assume the Baresip UA is running on host <code>192.168.1.1</code>, and the 
Simulated Receiver is running on host <code>192.168.1.2</code>.</p>
<ol>
<li>On the Baresip UA, dial our Simulated Receiver: <code>/dial sip:b@192.168.1.2:5071;transport=tls;mediaenc=srtp-mand</code>  </li>
<li>On the Simulated Receiver you should see the following output:  <div class="codehilite"><pre><span></span><span class="o">-----</span><span class="n">BEGIN</span> <span class="n">SSL</span> <span class="n">SESSION</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="n">MFUCAQECAgMDBALALAQABDCRfmQvTRw1xZZ0MJKtS2Vf7FG9J0</span><span class="o">/</span><span class="n">TVZnF</span><span class="o">+</span><span class="n">YNzGx</span><span class="o">/</span><span class="n">H</span>
<span class="n">xRuNTXrsClwHITWaTDQEB0yhBgIEXw0JLqIEAgIcIKQGBAQBAAAA</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">SSL</span> <span class="n">SESSION</span> <span class="n">PARAMETERS</span><span class="o">-----</span>
<span class="n">Shared</span> <span class="nl">ciphers</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">CHACHA20</span><span class="o">-</span><span class="nl">POLY1305</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">CHACHA20</span><span class="o">-</span><span class="nl">POLY1305</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">CHACHA20</span><span class="o">-</span><span class="nl">POLY1305</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">AES128</span><span class="o">-</span><span class="n">SHA</span>
<span class="n">CIPHER</span> <span class="n">is</span> <span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA384</span>
<span class="n">Secure</span> <span class="n">Renegotiation</span> <span class="n">IS</span> <span class="n">supported</span>
<span class="n">INVITE</span> <span class="nl">sip</span><span class="p">:</span><span class="n">xb192</span><span class="mf">.168.1.2</span><span class="o">:</span><span class="mi">5071</span><span class="p">;</span><span class="n">transport</span><span class="o">=</span><span class="n">tls</span><span class="p">;</span><span class="n">mediaenc</span><span class="o">=</span><span class="n">srtp</span><span class="o">-</span><span class="n">mand</span> <span class="n">SIP</span><span class="o">/</span><span class="mf">2.0</span>
<span class="nl">Via</span><span class="p">:</span> <span class="n">SIP</span><span class="o">/</span><span class="mf">2.0</span><span class="o">/</span><span class="n">TLS</span> <span class="mf">192.168.1.1</span><span class="o">:</span><span class="mi">5061</span><span class="p">;</span><span class="n">branch</span><span class="o">=</span><span class="n">z9hG4bKc141b65f66cd0e02</span><span class="p">;</span><span class="n">rport</span>
<span class="nl">Contact</span><span class="p">:</span> <span class="o">&lt;</span><span class="nl">sip</span><span class="p">:</span><span class="n">user</span><span class="o">-</span><span class="mh">0x55dc09027150</span><span class="mf">@192.168.1.1</span><span class="o">:</span><span class="mi">5061</span><span class="p">;</span><span class="n">transport</span><span class="o">=</span><span class="n">tls</span><span class="o">&gt;</span>
<span class="n">Max</span><span class="o">-</span><span class="nl">Forwards</span><span class="p">:</span> <span class="mi">70</span>
<span class="nl">To</span><span class="p">:</span> <span class="o">&lt;</span><span class="nl">sip</span><span class="p">:</span><span class="n">b</span><span class="mf">@192.168.1.2</span><span class="o">:</span><span class="mi">5071</span><span class="p">;</span><span class="n">transport</span><span class="o">=</span><span class="n">tls</span><span class="p">;</span><span class="n">mediaenc</span><span class="o">=</span><span class="n">srtp</span><span class="o">-</span><span class="n">mand</span><span class="o">&gt;</span>
<span class="nl">From</span><span class="p">:</span> <span class="o">&lt;</span><span class="nl">sip</span><span class="p">:</span><span class="n">a</span><span class="p">@</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">&gt;</span><span class="p">;</span><span class="n">tag</span><span class="o">=</span><span class="mi">0</span><span class="n">a94555cd2c228dd</span>
<span class="n">Call</span><span class="o">-</span><span class="nl">ID</span><span class="p">:</span> <span class="n">f9595791e9191927</span>
<span class="nl">CSeq</span><span class="p">:</span> <span class="mi">59280</span> <span class="n">INVITE</span>
<span class="n">User</span><span class="o">-</span><span class="nl">Agent</span><span class="p">:</span> <span class="n">baresip</span> <span class="n">v1</span><span class="mf">.0.0</span> <span class="p">(</span><span class="n">x86_64</span><span class="o">/</span><span class="n">linux</span><span class="p">)</span>
<span class="nl">Allow</span><span class="p">:</span> <span class="n">INVITE</span><span class="p">,</span><span class="n">ACK</span><span class="p">,</span><span class="n">BYE</span><span class="p">,</span><span class="n">CANCEL</span><span class="p">,</span><span class="n">OPTIONS</span><span class="p">,</span><span class="n">NOTIFY</span><span class="p">,</span><span class="n">SUBSCRIBE</span><span class="p">,</span><span class="n">INFO</span><span class="p">,</span><span class="n">MESSAGE</span><span class="p">,</span><span class="n">REFER</span>
<span class="nl">Supported</span><span class="p">:</span>
<span class="n">Content</span><span class="o">-</span><span class="nl">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">sdp</span>
<span class="n">Content</span><span class="o">-</span><span class="nl">Length</span><span class="p">:</span> <span class="mi">429</span>

<span class="n">v</span><span class="o">=</span><span class="mi">0</span>
<span class="n">o</span><span class="o">=-</span> <span class="mi">1975181172</span> <span class="mi">1106161735</span> <span class="n">IN</span> <span class="n">IP4</span> <span class="mf">192.168.1.1</span>
<span class="n">s</span><span class="o">=-</span>
<span class="n">c</span><span class="o">=</span><span class="n">IN</span> <span class="n">IP4</span> <span class="mf">192.168.1.1</span>
<span class="n">t</span><span class="o">=</span><span class="mi">0</span> <span class="mi">0</span>
<span class="n">a</span><span class="o">=</span><span class="nl">tool</span><span class="p">:</span><span class="n">baresip</span> <span class="mf">1.0.0</span>
<span class="n">m</span><span class="o">=</span><span class="n">audio</span> <span class="mi">16796</span> <span class="n">RTP</span><span class="o">/</span><span class="n">SAVP</span> <span class="mi">0</span> <span class="mi">8</span> <span class="mi">101</span>
<span class="n">a</span><span class="o">=</span><span class="nl">rtpmap</span><span class="p">:</span><span class="mi">0</span> <span class="n">PCMU</span><span class="o">/</span><span class="mi">8000</span>
<span class="n">a</span><span class="o">=</span><span class="nl">rtpmap</span><span class="p">:</span><span class="mi">8</span> <span class="n">PCMA</span><span class="o">/</span><span class="mi">8000</span>
<span class="n">a</span><span class="o">=</span><span class="nl">rtpmap</span><span class="p">:</span><span class="mi">101</span> <span class="n">telephone</span><span class="o">-</span><span class="n">event</span><span class="o">/</span><span class="mi">8000</span>
<span class="n">a</span><span class="o">=</span><span class="nl">fmtp</span><span class="p">:</span><span class="mi">101</span> <span class="mi">0</span><span class="o">-</span><span class="mi">15</span>
<span class="n">a</span><span class="o">=</span><span class="n">sendrecv</span>
<span class="n">a</span><span class="o">=</span><span class="nl">label</span><span class="p">:</span><span class="mi">1</span>
<span class="n">a</span><span class="o">=</span><span class="n">rtcp</span><span class="o">-</span><span class="n">rsize</span>
<span class="n">a</span><span class="o">=</span><span class="nl">ssrc</span><span class="p">:</span><span class="mi">2736692082</span> <span class="nl">cname</span><span class="p">:</span><span class="nl">sip</span><span class="p">:</span><span class="n">b</span><span class="p">@</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">a</span><span class="o">=</span><span class="nl">crypto</span><span class="p">:</span><span class="mi">1</span> <span class="n">AES_CM_128_HMAC_SHA1_80</span> <span class="kr">inline</span><span class="o">:</span><span class="n">vXMep</span><span class="o">/</span><span class="n">SIW4iMD21StWgrmy024dJZfOAM7qFFJfsJ</span>
<span class="n">a</span><span class="o">=</span><span class="nl">minptime</span><span class="p">:</span><span class="mi">20</span>
<span class="n">a</span><span class="o">=</span><span class="nl">ptime</span><span class="p">:</span><span class="mi">20</span>
</pre></div>


</li>
</ol>
<p>This output ensures the system meets the following standards:</p>
<p><strong>Signaling</strong>  </p>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, 
<a href="https://csrc.nist.gov/publications/detail/fips/197/final">FIPS 197</a> Advanced 
Encryption Standard (AES) with a 256 bit key (AES256): <code>CIPHER is ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final">SP 800-38D</a> Galois Counter Mode (GCM): <code>CIPHER is ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, <a href="https://csrc.nist.gov/publications/detail/fips/180/4/final">FIPS 180-4</a> Secure Hash Algorithm (SHA) with a Message Digest Size of 384 bits (SHA384): <code>CIPHER is ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4 Appendix D</a> Elliptic Curve P-384: <code>Server Temp Key: ECDH, P-384, 384 bits</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final">NIST SP 800-56A</a> Elliptic-curve Diffie–Hellman Key Agreement Protocol (ECDHE): <code>CIPHER is ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4</a> Elliptic-curve Digital Signature Algorithm (ECDSA): <code>CIPHER is ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
</ul>
<p><strong>Media</strong>  </p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc3711">RFC 3711</a> The Secure Real-time Transport Protocol (SRTP): <code>m=audio 33334 RTP/SAVP 0 8 101</code></li>
<li><a href="https://tools.ietf.org/html/rfc4568">RFC 4568</a> Session Description Protocol (SDP) Security Descriptions for Media Streams (SDES): <code>a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:gm+5A2moV/ylsWsC8GP1pg7BAbNrGQ8sKDr5HlFi</code></li>
<li><a href="https://tools.ietf.org/html/rfc4568">RFC 4568</a> SDES-SRTP Crypto-Suites: <code>a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:EFkFgnEbQwJrLhDKyMgzuJl2SLYDI1uW45CKyr6X</code>, specifically: <code>AES_CM_128_HMAC_SHA1_80</code></li>
</ul>
<h2>Receiving a Call in Baresip UA</h2>
<p>We're going to use the same Cert &amp; ECPK we created for the Baresip UA with the 
Simulated Sender. This will allow the Baresip UA to receive a TLS connection, and 
output the connection parameters in a manner viewable by the tester.</p>
<h3>Steps</h3>
<ol>
<li>On the host acting as the Simulated Sender, run the following command:<br />
<code>$ openssl s_client -connect localhost:5061 -cert example.cert -key example.key -cipher ECDHE-ECDSA-AES256-GCM-SHA384 -groups P-384</code></li>
<li>This will provide the following output: <div class="codehilite"><pre><span></span><span class="n">CONNECTED</span><span class="p">(</span><span class="mi">00000005</span><span class="p">)</span>
<span class="n">depth</span><span class="o">=</span><span class="mi">0</span> <span class="k">C</span> <span class="o">=</span> <span class="n">US</span><span class="p">,</span> <span class="n">ST</span> <span class="o">=</span> <span class="n">California</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">San</span> <span class="n">Francisco</span><span class="p">,</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Example</span> <span class="n">Co</span><span class="p">.,</span> <span class="n">OU</span> <span class="o">=</span> <span class="n">IT</span><span class="p">,</span> <span class="n">CN</span> <span class="o">=</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">verify</span> <span class="n">error</span><span class="p">:</span><span class="n">num</span><span class="o">=</span><span class="mi">18</span><span class="p">:</span><span class="k">self</span> <span class="n">signed</span> <span class="n">certificate</span>
<span class="n">verify</span> <span class="k">return</span><span class="p">:</span><span class="mi">1</span>
<span class="n">depth</span><span class="o">=</span><span class="mi">0</span> <span class="k">C</span> <span class="o">=</span> <span class="n">US</span><span class="p">,</span> <span class="n">ST</span> <span class="o">=</span> <span class="n">California</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">San</span> <span class="n">Francisco</span><span class="p">,</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Example</span> <span class="n">Co</span><span class="p">.,</span> <span class="n">OU</span> <span class="o">=</span> <span class="n">IT</span><span class="p">,</span> <span class="n">CN</span> <span class="o">=</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">verify</span> <span class="k">return</span><span class="p">:</span><span class="mi">1</span>
<span class="c1">---</span>
<span class="n">Certificate</span> <span class="k">chain</span>
 <span class="mi">0</span> <span class="n">s</span><span class="p">:</span><span class="o">/</span><span class="k">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">California</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">San</span> <span class="n">Francisco</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Example</span> <span class="n">Co</span><span class="p">.</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">IT</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
   <span class="n">i</span><span class="p">:</span><span class="o">/</span><span class="k">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">California</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">San</span> <span class="n">Francisco</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Example</span> <span class="n">Co</span><span class="p">.</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">IT</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="c1">---</span>
<span class="n">Server</span> <span class="n">certificate</span>
<span class="c1">-----BEGIN CERTIFICATE-----</span>
<span class="n">MIICEjCCAZkCCQDyk1urbYgWmTAKBggqhkjOPQQDAzBzMQswCQYDVQQGEwJVUzET</span>
<span class="n">MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzEUMBIG</span>
<span class="n">A1UECgwLRXhhbXBsZSBDby4xCzAJBgNVBAsMAklUMRQwEgYDVQQDDAtleGFtcGxl</span>
<span class="n">LmNvbTAeFw0yMDA3MTAyMzE1MDlaFw0yMDA4MDkyMzE1MDlaMHMxCzAJBgNVBAYT</span>
<span class="n">AlVTMRMwEQYDVQQIDApDYWxpZm9ybmlhMRYwFAYDVQQHDA1TYW4gRnJhbmNpc2Nv</span>
<span class="n">MRQwEgYDVQQKDAtFeGFtcGxlIENvLjELMAkGA1UECwwCSVQxFDASBgNVBAMMC2V4</span>
<span class="n">YW1wbGUuY29tMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEk7CKiDcMIzgGvuCk15dL</span>
<span class="n">ehSuyRNfx</span><span class="o">/</span><span class="mi">1</span><span class="n">qafjmAd0abH7NEMEgPITFd9oSK01kf2pfYRhIBWK1sWYd06dp9Ts5</span>
<span class="n">i5l4Mk1UOgaz</span><span class="o">+</span><span class="n">TzKEjM3yTg43LzzzZoQq23O2CzvWEe7MAoGCCqGSM49BAMDA2cA</span>
<span class="n">MGQCMAcL3m</span><span class="o">+</span><span class="n">Snelzz8uOrLRt1eZHbMRZc3C4hL05M7FC7DL</span><span class="o">+</span><span class="n">jxCokyfWnPU5KhyL</span>
<span class="n">RWov7wIweWQPr9Uvtovsov</span><span class="o">+</span><span class="mi">39</span><span class="n">eGU42Fitqqfv70o2SoXvRQ</span><span class="o">/</span><span class="mi">9</span><span class="n">XgDBKcHiKsQImPH</span>
<span class="n">Opagnxks</span>
<span class="c1">-----END CERTIFICATE-----</span>
<span class="n">subject</span><span class="o">=/</span><span class="k">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">California</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">San</span> <span class="n">Francisco</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Example</span> <span class="n">Co</span><span class="p">.</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">IT</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">issuer</span><span class="o">=/</span><span class="k">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">California</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">San</span> <span class="n">Francisco</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Example</span> <span class="n">Co</span><span class="p">.</span><span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">IT</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="c1">---</span>
<span class="k">No</span> <span class="n">client</span> <span class="n">certificate</span> <span class="n">CA</span> <span class="k">names</span> <span class="n">sent</span>
<span class="n">Server</span> <span class="n">Temp</span> <span class="k">Key</span><span class="p">:</span> <span class="n">ECDH</span><span class="p">,</span> <span class="n">P</span><span class="o">-</span><span class="mi">384</span><span class="p">,</span> <span class="mi">384</span> <span class="n">bits</span>
<span class="c1">---</span>
<span class="n">SSL</span> <span class="n">handshake</span> <span class="n">has</span> <span class="k">read</span> <span class="mi">1068</span> <span class="n">bytes</span> <span class="k">and</span> <span class="n">written</span> <span class="mi">262</span> <span class="n">bytes</span>
<span class="c1">---</span>
<span class="k">New</span><span class="p">,</span> <span class="n">TLSv1</span><span class="o">/</span><span class="n">SSLv3</span><span class="p">,</span> <span class="n">Cipher</span> <span class="k">is</span> <span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA384</span>
<span class="n">Server</span> <span class="k">public</span> <span class="k">key</span> <span class="k">is</span> <span class="mi">384</span> <span class="nb">bit</span>
<span class="n">Secure</span> <span class="n">Renegotiation</span> <span class="k">IS</span> <span class="n">supported</span>
<span class="n">Compression</span><span class="p">:</span> <span class="k">NONE</span>
<span class="n">Expansion</span><span class="p">:</span> <span class="k">NONE</span>
<span class="k">No</span> <span class="n">ALPN</span> <span class="n">negotiated</span>
<span class="n">SSL</span><span class="o">-</span><span class="k">Session</span><span class="p">:</span>
    <span class="n">Protocol</span>  <span class="p">:</span> <span class="n">TLSv1</span><span class="p">.</span><span class="mi">2</span>
    <span class="n">Cipher</span>    <span class="p">:</span> <span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="n">SHA384</span>
    <span class="k">Session</span><span class="o">-</span><span class="n">ID</span><span class="p">:</span> <span class="mi">0966</span><span class="n">C0600004F9A7DF9F67EF90FAAF412191E5239F38929CE80F495FEDD78352</span>
    <span class="k">Session</span><span class="o">-</span><span class="n">ID</span><span class="o">-</span><span class="n">ctx</span><span class="p">:</span>
    <span class="n">Master</span><span class="o">-</span><span class="k">Key</span><span class="p">:</span> <span class="n">AF01D67E554CF8B8BED9732CE8DEFD02C97FFBA9F7B1DF36E7E37163F3E1633250BD9E96FEBB35217BF3FC0ACB1668F8</span>
    <span class="n">TLS</span> <span class="k">session</span> <span class="n">ticket</span> <span class="n">lifetime</span> <span class="n">hint</span><span class="p">:</span> <span class="mi">7200</span> <span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="n">TLS</span> <span class="k">session</span> <span class="n">ticket</span><span class="p">:</span>
    <span class="mi">0000</span> <span class="o">-</span> <span class="mi">39</span> <span class="mi">65</span> <span class="n">eb</span> <span class="n">dd</span> <span class="mi">81</span> <span class="n">b8</span> <span class="mi">07</span> <span class="mi">1</span><span class="n">f</span><span class="o">-</span><span class="mi">2</span><span class="n">b</span> <span class="mi">0</span><span class="n">e</span> <span class="n">a3</span> <span class="mi">52</span> <span class="n">c1</span> <span class="n">c2</span> <span class="mi">3</span><span class="n">e</span> <span class="n">f1</span>   <span class="mi">9</span><span class="n">e</span><span class="p">......</span><span class="o">+</span><span class="p">..</span><span class="n">R</span><span class="p">..</span><span class="o">&gt;</span><span class="p">.</span>
    <span class="mi">0010</span> <span class="o">-</span> <span class="n">ba</span> <span class="mi">41</span> <span class="mi">2</span><span class="n">a</span> <span class="mi">58</span> <span class="mi">6</span><span class="n">e</span> <span class="n">b0</span> <span class="mi">16</span> <span class="mi">28</span><span class="o">-</span><span class="mi">56</span> <span class="n">e5</span> <span class="n">a4</span> <span class="mi">81</span> <span class="n">c3</span> <span class="mi">7</span><span class="k">c</span> <span class="n">a3</span> <span class="n">ee</span>   <span class="p">.</span><span class="n">A</span><span class="o">*</span><span class="n">Xn</span><span class="p">..(</span><span class="n">V</span><span class="p">....</span><span class="o">|</span><span class="p">..</span>
    <span class="mi">0020</span> <span class="o">-</span> <span class="mi">8</span><span class="n">d</span> <span class="n">ba</span> <span class="mi">7</span><span class="n">f</span> <span class="mi">4</span><span class="n">e</span> <span class="n">ff</span> <span class="mi">65</span> <span class="mi">53</span> <span class="n">ef</span><span class="o">-</span><span class="n">be</span> <span class="mi">80</span> <span class="n">c8</span> <span class="mi">98</span> <span class="n">ca</span> <span class="mi">12</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">8</span><span class="k">c</span>   <span class="p">...</span><span class="n">N</span><span class="p">.</span><span class="n">eS</span><span class="p">.........</span>
    <span class="mi">0030</span> <span class="o">-</span> <span class="n">c9</span> <span class="n">e1</span> <span class="n">f8</span> <span class="n">c7</span> <span class="n">cc</span> <span class="n">d7</span> <span class="n">f5</span> <span class="mi">6</span><span class="k">c</span><span class="o">-</span><span class="mi">8</span><span class="n">d</span> <span class="n">bc</span> <span class="n">f1</span> <span class="mi">3</span><span class="n">e</span> <span class="mi">53</span> <span class="mi">09</span> <span class="mi">43</span> <span class="mi">2</span><span class="n">f</span>   <span class="p">.......</span><span class="n">l</span><span class="p">...</span><span class="o">&gt;</span><span class="n">S</span><span class="p">.</span><span class="k">C</span><span class="o">/</span>
    <span class="mi">0040</span> <span class="o">-</span> <span class="n">b9</span> <span class="mi">7</span><span class="k">c</span> <span class="mi">3</span><span class="n">f</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">9</span><span class="n">e</span> <span class="mi">39</span> <span class="mi">30</span> <span class="n">cf</span><span class="o">-</span><span class="n">f2</span> <span class="n">eb</span> <span class="mi">72</span> <span class="n">fd</span> <span class="n">f3</span> <span class="mi">51</span> <span class="mi">08</span> <span class="mi">25</span>   <span class="p">.</span><span class="o">|?</span><span class="p">..</span><span class="mi">90</span><span class="p">...</span><span class="n">r</span><span class="p">..</span><span class="n">Q</span><span class="p">.</span><span class="o">%</span>
    <span class="mi">0050</span> <span class="o">-</span> <span class="n">f1</span> <span class="mi">4</span><span class="n">a</span> <span class="mi">58</span> <span class="mi">49</span> <span class="n">f0</span> <span class="mi">11</span> <span class="n">c1</span> <span class="mi">75</span><span class="o">-</span><span class="mi">03</span> <span class="n">ef</span> <span class="mi">79</span> <span class="mi">93</span> <span class="mi">9</span><span class="n">f</span> <span class="mi">20</span> <span class="mi">85</span> <span class="n">ba</span>   <span class="p">.</span><span class="n">JXI</span><span class="p">...</span><span class="n">u</span><span class="p">..</span><span class="n">y</span><span class="p">..</span> <span class="p">..</span>
    <span class="mi">0060</span> <span class="o">-</span> <span class="n">d2</span> <span class="mi">80</span> <span class="mi">73</span> <span class="mi">2</span><span class="n">d</span> <span class="mi">9</span><span class="n">e</span> <span class="mi">6</span><span class="n">a</span> <span class="mi">03</span> <span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="n">a6</span> <span class="mi">38</span> <span class="mi">2</span><span class="k">c</span> <span class="mi">75</span> <span class="n">f4</span> <span class="n">d1</span> <span class="n">c5</span> <span class="mi">67</span>   <span class="p">..</span><span class="n">s</span><span class="o">-</span><span class="p">.</span><span class="n">j</span><span class="p">.</span><span class="o">~</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="n">u</span><span class="p">...</span><span class="k">g</span>
    <span class="mi">0070</span> <span class="o">-</span> <span class="mi">44</span> <span class="mi">09</span> <span class="n">ae</span> <span class="n">f0</span> <span class="mi">7</span><span class="n">d</span> <span class="n">ad</span> <span class="mi">0</span><span class="n">e</span> <span class="n">b5</span><span class="o">-</span><span class="mi">6</span><span class="k">c</span> <span class="n">b2</span> <span class="mi">3</span><span class="k">c</span> <span class="n">b0</span> <span class="n">ca</span> <span class="mi">28</span> <span class="mi">4</span><span class="n">d</span> <span class="mi">1</span><span class="k">c</span>   <span class="n">D</span><span class="p">...</span><span class="err">}</span><span class="p">...</span><span class="n">l</span><span class="p">.</span><span class="o">&lt;</span><span class="p">..(</span><span class="n">M</span><span class="p">.</span>
    <span class="mi">0080</span> <span class="o">-</span> <span class="n">e0</span> <span class="mi">04</span> <span class="n">c9</span> <span class="mi">5</span><span class="n">e</span> <span class="mi">6</span><span class="n">b</span> <span class="n">dd</span> <span class="mi">8</span><span class="n">d</span> <span class="n">e1</span><span class="o">-</span><span class="n">a6</span> <span class="mi">81</span> <span class="mi">19</span> <span class="mi">03</span> <span class="n">c4</span> <span class="n">b9</span> <span class="mi">77</span> <span class="mi">4</span><span class="n">b</span>   <span class="p">...</span><span class="o">^</span><span class="n">k</span><span class="p">.........</span><span class="n">wK</span>
    <span class="mi">0090</span> <span class="o">-</span> <span class="mi">2</span><span class="n">f</span> <span class="mi">61</span> <span class="mi">5</span><span class="n">f</span> <span class="mi">72</span> <span class="mi">2</span><span class="n">d</span> <span class="n">d7</span> <span class="n">f9</span> <span class="n">c0</span><span class="o">-</span><span class="mi">65</span> <span class="mi">18</span> <span class="mi">30</span> <span class="mi">72</span> <span class="mi">85</span> <span class="mi">10</span> <span class="mi">99</span> <span class="mi">55</span>   <span class="o">/</span><span class="n">a_r</span><span class="o">-</span><span class="p">...</span><span class="n">e</span><span class="p">.</span><span class="mi">0</span><span class="n">r</span><span class="p">...</span><span class="n">U</span>

    <span class="k">Start</span> <span class="k">Time</span><span class="p">:</span> <span class="mi">1594689170</span>
    <span class="n">Timeout</span>   <span class="p">:</span> <span class="mi">7200</span> <span class="p">(</span><span class="n">sec</span><span class="p">)</span>
    <span class="n">Verify</span> <span class="k">return</span> <span class="n">code</span><span class="p">:</span> <span class="mi">18</span> <span class="p">(</span><span class="k">self</span> <span class="n">signed</span> <span class="n">certificate</span><span class="p">)</span>
<span class="c1">---</span>
</pre></div>


</li>
</ol>
<p>This output ensures the system meets the following standards:</p>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, 
<a href="https://csrc.nist.gov/publications/detail/fips/197/final">FIPS 197</a> Advanced 
Encryption Standard (AES) with a 256 bit key (AES256): <code>Cipher    : ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final">SP 800-38D</a> Galois Counter Mode (GCM): <code>Cipher    : ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">FIPS 140-2 Annex A</a>, <a href="https://csrc.nist.gov/publications/detail/fips/180/4/final">FIPS 180-4</a> Secure Hash Algorithm (SHA) with a Message Digest Size of 384 bits (SHA384): <code>Cipher    : ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4 Appendix D</a> Elliptic Curve P-384: <code>Server Temp Key: ECDH, P-384, 384 bits</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final">NIST SP 800-56A</a> Elliptic-curve Diffie–Hellman Key Agreement Protocol (ECDHE): <code>Cipher    : ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">FIPS 186-4</a> Elliptic-curve Digital Signature Algorithm (ECDSA): <code>Cipher    : ECDHE-ECDSA-AES256-GCM-SHA384</code></li>
</ul>
<!-- endblock templates/article.html content -->

<!-- endblock templates/base.html content -->
</div>


<!-- block templates/article.html footer -->
<h2>Share</h2>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="ampledata">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'ampledata';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<!-- block templates/base.html footer -->
<footer class="footer">
  <div class="container">
      Contact Greg Albrecht: Email <a
        href="mailto:gba@gregalbrecht.com">gba@gregalbrecht.com</a> Twitter <a
        href="http://twitter.com/ampledata">@ampledata</a> Github <a
        href="https://github.com/ampledata">ampledata</a>.

      <p>This work by <a href="http://twitter.com/ampledata">Greg Albrecht</a> is licensed under a <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>. Based on a work at <a href="http://ampledata.org">ampledata.org</a>.</p>
  </div>
</footer>
<!-- endblock templates/base.html footer -->

<!-- endblock templates/article.html footer -->



<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>